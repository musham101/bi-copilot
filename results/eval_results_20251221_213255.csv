row_id,source_file,user_query,gold_sql,pred_sql,api_ok,api_error,latency_s,exact_match,normalized_exact_match,token_precision,token_recall,token_f1,keyword_precision,keyword_recall,keyword_f1,edit_similarity,judge_equivalent,judge_score_0_5,judge_reason,relevant_tables,returned_columns
0,test.csv,Find the products supplied by more than 2 vendors.,"SELECT ProductID, COUNT(*) AS VendorCount FROM ProductVendor GROUP BY ProductID HAVING VendorCount > 2;","SELECT pv.ProductID
FROM ProductVendor pv
GROUP BY pv.ProductID
HAVING COUNT(DISTINCT pv.BusinessEntityID) > 2;",True,,7.410393953323364,False,False,0.5909090909090909,0.7222222222222222,0.65,0.8333333333333334,0.8333333333333334,0.8333333333333334,0.42727272727272725,True,5.0,"Both SQL queries effectively count the number of vendors for each product and filter for those with more than two vendors, maintaining the same logical structure and conditions.","[""ProductVendor""]","[""ProductID""]"
1,test.csv,List the product categories along with the number of subcategories in each product category?,"SELECT pc.ProductCategoryID, pc.Name AS ProductCategoryName, COUNT(ps.ProductSubcategoryID) AS SubCategoryCount FROM ProductCategory pc LEFT JOIN ProductSubcategory ps ON pc.ProductCategoryID = ps.ProductCategoryID GROUP BY pc.ProductCategoryID, pc.Name ORDER BY pc.ProductCategoryID;","SELECT pc.Name, COUNT(ps.ProductSubcategoryID) AS SubcategoryCount
FROM ProductCategory pc
LEFT JOIN ProductSubcategory ps ON pc.ProductCategoryID = ps.ProductCategoryID
GROUP BY pc.ProductCategoryID, pc.Name;",True,,9.792677879333496,False,False,1.0,0.7708333333333334,0.8705882352941177,1.0,0.8888888888888888,0.9411764705882353,0.734982332155477,True,5.0,"Both SQL queries accurately count the number of subcategories per product category and include the same grouping and join conditions, differing only in column formatting and ordering, which do not affect semantics.","[""ProductCategory"", ""ProductSubcategory""]","[""Name"", ""SubcategoryCount""]"
2,test.csv,Get the top 5 customers by total revenue.,"SELECT c.CustomerID, SUM(soh.TotalDue) AS Revenue FROM SalesOrderHeader soh JOIN Customer c ON soh.CustomerID = c.CustomerID GROUP BY c.CustomerID ORDER BY Revenue DESC LIMIT 5;","SELECT c.CustomerID, SUM(so.TotalDue) AS TotalRevenue
FROM Customer c
JOIN SalesOrderHeader so ON c.CustomerID = so.CustomerID
GROUP BY c.CustomerID
ORDER BY TotalRevenue DESC
LIMIT 5;",True,,7.4702630043029785,False,False,0.868421052631579,0.868421052631579,0.868421052631579,1.0,1.0,1.0,0.7540983606557377,True,5.0,"Both SQL queries calculate the same value (total revenue) grouped by CustomerID, use the same joins, and limit the results to the top 5 customers based on revenue.","[""Customer"", ""SalesOrderHeader""]","[""CustomerID"", ""TotalRevenue""]"
3,test.csv,Retrieve all products that have never been ordered.,"SELECT p.ProductID, p.Name FROM Product p LEFT JOIN SalesOrderDetail sod ON p.ProductID = sod.ProductID WHERE sod.ProductID IS NULL;","SELECT p.ProductID, p.Name
FROM Product p
LEFT JOIN SalesOrderDetail sod ON p.ProductID = sod.ProductID
WHERE sod.ProductID IS NULL;",True,,7.224064111709595,False,True,1.0,1.0,1.0,1.0,1.0,1.0,1.0,True,5.0,"Both GOLD and PREDICTED SQL queries are identical in structure and functionality, retrieving the same results without any differences in selection or filtering.","[""Product"", ""SalesOrderDetail""]","[""ProductID"", ""Name""]"
4,test.csv,Get the total sales value for each month of each year.,"SELECT YEAR(OrderDate) AS Yr, MONTH(OrderDate) AS Mn, SUM(TotalDue) AS TotalSales FROM SalesOrderHeader GROUP BY YEAR(OrderDate), MONTH(OrderDate) ORDER BY Yr, Mn;","SELECT 
    YEAR(soh.OrderDate) AS Year, 
    MONTH(soh.OrderDate) AS Month, 
    SUM(soh.TotalDue) AS TotalSales
FROM 
    SalesOrderHeader AS soh
GROUP BY 
    YEAR(soh.OrderDate), 
    MONTH(soh.OrderDate)
ORDER BY 
    Year, Month;",True,,7.714193105697632,False,False,0.6862745098039216,0.8974358974358975,0.7777777777777778,1.0,1.0,1.0,0.8140703517587939,True,5.0,"Both GOLD and PREDICTED SQLs correctly calculate the total sales value for each month of each year and use the same grouping and ordering criteria, with only differences in aliases and formatting.","[""SalesOrderHeader""]","[""Year"", ""Month"", ""TotalSales""]"
5,val.csv,Find the top-selling product in each year.,"SELECT Year, ProductID, Name, TotalQty FROM (SELECT YEAR(soh.OrderDate) AS Year, p.ProductID, p.Name, SUM(sod.OrderQty) AS TotalQty, ROW_NUMBER() OVER (PARTITION BY YEAR(soh.OrderDate) ORDER BY SUM(sod.OrderQty) DESC) AS rn FROM SalesOrderHeader soh JOIN SalesOrderDetail sod ON soh.SalesOrderID = sod.SalesOrderID JOIN Product p ON sod.ProductID = p.ProductID GROUP BY Year, p.ProductID) AS T WHERE rn = 1;",,False,500 Server Error: Internal Server Error for url: http://localhost:8000/query,32.09457778930664,False,False,0.0,0.0,0.0,0.0,0.0,0.0,0.0,,,,[],[]
6,val.csv,Retrieve the most expensive product in each category.,"SELECT pc.ProductCategoryID, pc.Name AS Category, p.ProductID, p.Name, p.ListPrice FROM ProductCategory pc JOIN ProductSubcategory ps ON pc.ProductCategoryID = ps.ProductCategoryID JOIN Product p ON ps.ProductSubcategoryID = p.ProductSubcategoryID WHERE p.ListPrice = (SELECT MAX(p2.ListPrice) FROM Product p2 JOIN ProductSubcategory ps2 ON p2.ProductSubcategoryID = ps2.ProductSubcategoryID WHERE ps2.ProductCategoryID = pc.ProductCategoryID);",,False,500 Server Error: Internal Server Error for url: http://localhost:8000/query,10.202949047088623,False,False,0.0,0.0,0.0,0.0,0.0,0.0,0.0,,,,[],[]
7,val.csv,Which products have the highest and lowest profit margins? List 5 each.,"(SELECT 'Highest Margin' AS MarginType, p.Name AS ProductName, p.ListPrice, p.StandardCost, (p.ListPrice - p.StandardCost) AS ProfitPerUnit, ROUND(((p.ListPrice - p.StandardCost) / p.ListPrice) * 100, 2) AS MarginPercentage FROM Product p WHERE p.ListPrice > 0 AND p.StandardCost > 0 ORDER BY MarginPercentage DESC LIMIT 5) UNION ALL (SELECT 'Lowest Margin' AS MarginType, p.Name AS ProductName, p.ListPrice, p.StandardCost, (p.ListPrice - p.StandardCost) AS ProfitPerUnit, ROUND(((p.ListPrice - p.StandardCost) / p.ListPrice) * 100, 2) AS MarginPercentage FROM Product p WHERE p.ListPrice > 0 AND p.StandardCost > 0 AND (p.ListPrice - p.StandardCost) > 0 ORDER BY MarginPercentage ASC LIMIT 5);","(
    SELECT p.ProductID, p.Name, (p.ListPrice - plph.ListPrice) AS ProfitMargin
    FROM Product p
    JOIN ProductListPriceHistory plph ON p.ProductID = plph.ProductID
    WHERE plph.StartDate = (
        SELECT MAX(StartDate)
        FROM ProductListPriceHistory
        WHERE ProductID = p.ProductID
    )
    ORDER BY ProfitMargin DESC
    LIMIT 5
)
UNION ALL
(
    SELECT p.ProductID, p.Name, (p.ListPrice - plph.ListPrice) AS ProfitMargin
    FROM Product p
    JOIN ProductListPriceHistory plph ON p.ProductID = plph.ProductID
    WHERE plph.StartDate = (
        SELECT MAX(StartDate)
        FROM ProductListPriceHistory
        WHERE ProductID = p.ProductID
    )
    ORDER BY ProfitMargin ASC
    LIMIT 5
);",True,,12.035398244857788,False,False,0.6129032258064516,0.46060606060606063,0.5259515570934257,0.8181818181818182,0.9,0.8571428571428572,0.33429394812680113,False,2.0,"The GOLD_SQL calculates profit margins based on ListPrice and StandardCost, while PREDICTED_SQL uses ProductListPriceHistory to calculate ProfitMargin, which could lead to different results.","[""Product"", ""ProductListPriceHistory""]","[""ProductID"", ""Name"", ""ProfitMargin""]"
8,val.csv,Show all sales orders placed in 2011.,"SELECT SalesOrderID, SalesOrderNumber, OrderDate FROM SalesOrderHeader WHERE YEAR(OrderDate) = 2011;","SELECT soh.OrderDate, c.AccountNumber, b.AddressLine1 AS BillToAddress, b.City AS BillToCity, 
       s.AddressLine1 AS ShipToAddress, s.City AS ShipToCity
FROM SalesOrderHeader AS soh
JOIN Customer AS c ON soh.CustomerID = c.CustomerID
JOIN Address AS b ON soh.BillToAddressID = b.AddressID
JOIN Address AS s ON soh.ShipToAddressID = s.AddressID
WHERE YEAR(soh.OrderDate) = 2011;",True,,31.56000781059265,False,False,0.1566265060240964,0.8666666666666667,0.2653061224489796,0.5,1.0,0.6666666666666666,0.23450134770889486,False,2.0,"The GOLD SQL queries only for SalesOrderID, SalesOrderNumber, and OrderDate, while the PREDICTED SQL retrieves additional columns from related tables, changing the scope of the result.","[""SalesOrderHeader"", ""Customer"", ""Address""]","[""OrderDate"", ""AccountNumber"", ""BillToAddress"", ""BillToCity"", ""ShipToAddress"", ""ShipToCity""]"
9,val.csv,Customers who purchased more than 100 different products.,"SELECT soh.CustomerID, COUNT(DISTINCT sod.ProductID) AS UniqueProducts FROM SalesOrderHeader soh JOIN SalesOrderDetail sod ON soh.SalesOrderID = sod.SalesOrderID GROUP BY soh.CustomerID HAVING UniqueProducts > 100;","SELECT c.CustomerID
FROM Customer c
JOIN SalesOrderHeader soh ON c.CustomerID = soh.CustomerID
JOIN SalesOrderDetail sod ON soh.SalesOrderID = sod.SalesOrderID
GROUP BY c.CustomerID
HAVING COUNT(DISTINCT sod.ProductID) > 100;",True,,11.351725101470947,False,False,0.7272727272727273,0.8648648648648649,0.7901234567901235,1.0,0.8888888888888888,0.9411764705882353,0.5982142857142857,True,5.0,"Both queries count distinct products purchased by customers and filter for those with more than 100, achieving the same result using different table aliases.","[""Customer"", ""SalesOrderDetail""]","[""CustomerID""]"
10,val.csv,Retrieve all employees who worked in more than 1 department.,"SELECT BusinessEntityID, COUNT(DISTINCT DepartmentID) AS DeptCount FROM EmployeeDepartmentHistory GROUP BY BusinessEntityID HAVING DeptCount > 1;","SELECT e.BusinessEntityID, p.FirstName, p.LastName
FROM EmployeeDepartmentHistory edh
JOIN Employee e ON edh.BusinessEntityID = e.BusinessEntityID
JOIN Person p ON e.BusinessEntityID = p.BusinessEntityID
GROUP BY edh.BusinessEntityID
HAVING COUNT(DISTINCT edh.DepartmentID) > 1;",True,,9.297592163085938,False,False,0.3076923076923077,0.8421052631578947,0.4507042253521127,0.75,0.8571428571428571,0.7999999999999999,0.3790613718411552,False,3.0,"The PREDICTED SQL includes additional columns (FirstName, LastName) from the Person table that are not present in the GOLD SQL, altering the output structure, though the filtering condition remains the same.","[""Employee"", ""EmployeeDepartmentHistory"", ""Department""]","[""BusinessEntityID"", ""FirstName"", ""LastName""]"
11,val.csv,List all orders shipped to Canada.,"SELECT soh.SalesOrderID, cr.Name AS CountryName FROM SalesOrderHeader soh JOIN Address a ON soh.ShipToAddressID = a.AddressID JOIN StateProvince sp ON a.StateProvinceID = sp.StateProvinceID JOIN CountryRegion cr ON sp.CountryRegionCode = cr.CountryRegionCode WHERE cr.Name = 'Canada';",,False,500 Server Error: Internal Server Error for url: http://localhost:8000/query,11.628840923309326,False,False,0.0,0.0,0.0,0.0,0.0,0.0,0.0,,,,[],[]
12,val.csv,Which states or provinces bring in the most sales? List top 15.,"SELECT sp.Name AS StateProvince, cr.Name AS Country, SUM(soh.TotalDue) AS TotalSales FROM SalesOrderHeader soh JOIN Address a ON soh.ShipToAddressID = a.AddressID JOIN StateProvince sp ON a.StateProvinceID = sp.StateProvinceID JOIN CountryRegion cr ON sp.CountryRegionCode = cr.CountryRegionCode GROUP BY sp.StateProvinceID, sp.Name, cr.Name ORDER BY TotalSales DESC LIMIT 15;","SELECT sp.Name, SUM(soh.TotalDue) AS TotalSales
FROM SalesOrderHeader AS soh
JOIN StateProvince AS sp ON soh.TerritoryID = sp.TerritoryID
GROUP BY sp.Name
ORDER BY TotalSales DESC
LIMIT 15;",True,,8.69777798652649,False,False,0.95,0.5,0.6551724137931034,1.0,1.0,1.0,0.4666666666666667,False,1.0,"The GOLD SQL aggregates sales by state or province including the country, while the PREDICTED SQL aggregates only by state or province and joins on a different key (TerritoryID instead of ShipToAddressID).","[""SalesOrderHeader"", ""StateProvince""]","[""Name"", ""TotalSales""]"
13,val.csv,Retrieve vendors who supply only products in one single category.,SELECT pv.BusinessEntityID FROM ProductVendor pv JOIN Product p ON pv.ProductID = p.ProductID JOIN ProductSubcategory ps ON p.ProductSubcategoryID = ps.ProductSubcategoryID GROUP BY pv.BusinessEntityID HAVING COUNT(DISTINCT ps.ProductCategoryID) = 1;,"SELECT v.Name
FROM Vendor v
JOIN ProductVendor pv ON v.BusinessEntityID = pv.BusinessEntityID
JOIN Product p ON pv.ProductID = p.ProductID
JOIN ProductSubcategory ps ON p.ProductSubcategoryID = ps.ProductSubcategoryID
JOIN ProductCategory pc ON ps.ProductCategoryID = pc.ProductCategoryID
GROUP BY v.BusinessEntityID
HAVING COUNT(DISTINCT ps.ProductCategoryID) = 1;",True,,35.3610999584198,False,False,0.6515151515151515,0.9772727272727273,0.7818181818181817,1.0,1.0,1.0,0.6263736263736264,False,3.0,"The PREDICTED_SQL retrieves vendor names instead of BusinessEntityIDs, which changes the output format. However, both queries are checking for vendors supplying products within a single category, hence the score is moderate.","[""Product"", ""ProductCategory"", ""ProductVendor"", ""Vendor""]","[""Name""]"
14,val.csv,Find products whose list price is above the average list price of their category.,"SELECT p.ProductID, p.Name, p.ListPrice, AvgPrices.AvgListPrice FROM Product p JOIN ProductSubcategory ps ON p.ProductSubcategoryID = ps.ProductSubcategoryID JOIN ProductCategory pc ON ps.ProductCategoryID = pc.ProductCategoryID JOIN (SELECT ps2.ProductCategoryID, AVG(p2.ListPrice) AS AvgListPrice FROM Product p2 JOIN ProductSubcategory ps2 ON p2.ProductSubcategoryID = ps2.ProductSubcategoryID GROUP BY ps2.ProductCategoryID) AS AvgPrices ON pc.ProductCategoryID = AvgPrices.ProductCategoryID WHERE p.ListPrice > AvgPrices.AvgListPrice;","SELECT p.*
FROM Product p
JOIN ProductSubcategory ps ON p.ProductSubcategoryID = ps.ProductSubcategoryID
JOIN ProductCategory pc ON ps.ProductCategoryID = pc.ProductCategoryID
WHERE p.ListPrice > (
    SELECT AVG(p2.ListPrice)
    FROM Product p2
    JOIN ProductSubcategory ps2 ON p2.ProductSubcategoryID = ps2.ProductSubcategoryID
    WHERE ps2.ProductCategoryID = ps.ProductCategoryID
)",True,,10.605395793914795,False,False,0.971830985915493,0.6831683168316832,0.8023255813953488,1.0,0.625,0.7692307692307693,0.6394052044609666,True,5.0,"Both SQL queries retrieve products with a list price above the average list price of their category, using different methods to compute the average, but they yield the same results.","[""Product"", ""ProductCategory""]","[""ProductID"", ""Name"", ""ProductNumber"", ""MakeFlag"", ""FinishedGoodsFlag"", ""Color"", ""SafetyStockLevel"", ""ReorderPoint"", ""StandardCost"", ""ListPrice"", ""Size"", ""SizeUnitMeasureCode"", ""WeightUnitMeasureCode"", ""Weight"", ""DaysToManufacture"", ""ProductLine"", ""Class"", ""Style"", ""ProductSubcategoryID"", ""ProductModelID"", ""SellStartDate"", ""SellEndDate"", ""DiscontinuedDate"", ""rowguid"", ""ModifiedDate""]"
